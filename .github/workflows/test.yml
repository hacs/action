name: HACS Action
on:
  pull_request:
  push:
    branches:
      - main

jobs:
  lint:
    runs-on: ubuntu-latest
    name: Lint
    steps:
      - name: Checkout the repository
        uses: actions/checkout@v3

      - name: Run ShellCheck
        uses: ludeeus/action-shellcheck@master
        with:
          additional_files: run common checks helpers
        env:
          SHELLCHECK_OPTS: --exclude SC2034

  repository:
    needs: lint
    runs-on: ubuntu-latest
    name: "${{ matrix.repository.category }}: ${{ matrix.repository.name }}"
    strategy:
      matrix:
        repository:
          - { "name": "hacs/integration", "category": "integration" }
          - {
              "name": "basnijholt/lovelace-ios-dark-mode-theme",
              "category": "theme",
            }
          - {
              "name": "home-assistant-community-themes/template",
              "category": "theme",
            }
          - {
              "name": "ofekashery/vertical-stack-in-card",
              "category": "plugin",
              "ignore": "images",
            }
          - {
              "name": "custom-cards/boilerplate-card",
              "category": "plugin",
              "ignore": "images",
            }
          - {
              "name": "hacs/ND-NotifyUpdates",
              "category": "netdaemon",
              "ignore": "topics",
            }
          - {
              "name": "net-daemon/netdaemon-app-template",
              "category": "netdaemon",
              "ignore": "topics",
            }
          - {
              "name": "ludeeus/ad-hacs",
              "category": "appdaemon",
              "ignore": "hacsjson",
            }
          - {
              "name": "ludeeus/ps-hacs",
              "category": "python_scripts",
              "ignore": "hacsjson information",
            }
    steps:
      - name: Checkout the repository
        uses: actions/checkout@v3

      - name: HACS Action
        uses: ./
        with:
          comment: false
          category: ${{ matrix.repository.category }}
          ignore: ${{ matrix.repository.ignore }}
          repository: ${{ matrix.repository.name }}
